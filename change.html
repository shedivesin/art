<!doctype html>
<style>canvas{display:block;margin:auto}</style>
<canvas></canvas>
<script>
"use strict";


function lerp(a, b, t) { return a + (b - a) * t; }
function constrain(t, min, max) { return (t > min)? ((t < max)? t: max): min; }


function noise(t, entropy) {
  const n = entropy.length >> 1;
  let sum = 0;

  for(let i = 0; i < n; i++) {
    const amplitude = (1 / 65535) * Math.pow(2, -(i + 1)) * entropy[i * 2 + 0];
    const frequency = (2 * Math.PI) * Math.pow(2, i);
    const offset = (Math.PI / 32768) * entropy[i * 2 + 1];

    sum += amplitude * Math.sin(frequency * t + offset);
  }

  return sum;
}


const entropy = new Uint16Array(96);
function reset() { crypto.getRandomValues(entropy); }


const entropy_x = new Uint16Array(entropy.buffer, entropy.byteOffset +  0, 32);
const entropy_y = new Uint16Array(entropy.buffer, entropy.byteOffset + 32, 32);
const entropy_z = new Uint16Array(entropy.buffer, entropy.byteOffset + 64, 32);
function noise_x(t) { return noise(t, entropy_x); }
function noise_y(t) { return noise(t, entropy_y); }
function noise_z(t) { return noise(t, entropy_z); }


function dot(id, x, y, z, w) {
  x = z * noise_x(w) + x;
  y = z * noise_y(w) + y;
  z = z * (0.5 * noise_z(w) + 1);

  const min_u = constrain(Math.floor(x - z), 0, id.width);
  const max_u = constrain(Math.ceil(x + z), 0, id.width);
  const min_v = constrain(Math.floor(y - z), 0, id.height);
  const max_v = constrain(Math.ceil(y + z), 0, id.height);

  for(let v = min_v; v < max_v; v++) {
    const dv = v - y;

    for(let u = min_u; u < max_u; u++) {
      const du = u - x;

      if(du * du + dv * dv <= z * z) {
        let i = (v * id.width + u) * 4;

        id.data[i++] = 0;
        id.data[i++] = 0;
        id.data[i++] = 0;
        id.data[i++] = 255;
      }
    }
  }
}

function line(id, x1, y1, z1, w1, x2, y2, z2, w2) {
  const n = Math.ceil(Math.hypot(x2 - x1, y2 - y1));

  for(let i = 0; i < n; i++) {
    const t = i / n;

    dot(id, lerp(x1, x2, t), lerp(y1, y2, t), lerp(z1, z2, t), lerp(w1, w2, t));
  }
}

function ellipse(id, x, y, rx, ry, a1, z1, w1, a2, z2, w2) {
  const n = Math.ceil((2 * Math.PI) * Math.abs(a2 - a1) * Math.max(rx, ry));

  for(let i = 0; i < n; i++) {
    const t = i / n;
    const a = (2 * Math.PI) * lerp(a1, a2, t);

    dot(id, x + Math.sin(a) * rx, y - Math.cos(a) * ry, lerp(z1, z2, t), lerp(w1, w2, t));
  }
}


const s = 24;
const canvas = document.getElementsByTagName("canvas")[0];
canvas.width = 6*s;
canvas.height = 26*s;
const ctx = canvas.getContext("2d");
const id = ctx.getImageData(0, 0, canvas.width, canvas.height);

reset();
ellipse(id, 3*s, 1*s, 2*s, 2*s, 0.25, s/14, 0.0, 0.75, s/14, 0.5);
ellipse(id, 3*s, 1*s, 2*s, 1*s, 0.25, s/14, 1.0, 0.75, s/14, 0.5);

reset();
ellipse(id, 3*s, 4*s, 2*s, 2*s, 0.25, s/14, 0.0, 0.75, s/14, 0.5);
line(id, 1*s, 4*s, s/14, 0.5, 5*s, 4*s, s/14, 1.0);

reset();
ellipse(id, 3*s, 8*s, 2*s, 2*s, 0.25, s/14, 0.0, 0.75, s/14, 0.5);
ellipse(id, 3*s, 8*s, 2*s, 1*s, 0.75, s/14, 0.5, 1.25, s/14, 1.0);

reset();
ellipse(id, 3*s, 13*s, 2*s, 2*s, 0, s/14, 0, 1, s/14, 1);

reset();
ellipse(id, 3*s, 18*s, 2*s, 1*s, 0.25, s/14, 0.0, 0.75, s/14, 0.5);
ellipse(id, 3*s, 18*s, 2*s, 2*s, 0.75, s/14, 0.5, 1.25, s/14, 1.0);

reset();
ellipse(id, 3*s, 22*s, 2*s, 2*s, 0.75, s/14, 0.0, 1.25, s/14, 0.5);
line(id, 1*s, 22*s, s/14, 1.0, 5*s, 22*s, s/14, 0.5);

reset();
ellipse(id, 3*s, 25*s, 2*s, 2*s, 0.75, s/14, 0.0, 1.25, s/14, 0.5);
ellipse(id, 3*s, 25*s, 2*s, 1*s, 0.75, s/14, 1.0, 1.25, s/14, 0.5);

ctx.putImageData(id, 0, 0);
</script>
