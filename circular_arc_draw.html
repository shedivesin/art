<!doctype html>
<canvas></canvas>
<script>
"use strict";
const WIDTH = 6;
const HEIGHT = 26;
const STROKE = 1/14;
const SCALE = 24;


const ENTROPY = new Uint8Array(256);

function next() {
  crypto.getRandomValues(ENTROPY);
}

function lerp(a, b, t) {
  return a + (b - a) * t;
}

function octave(t) {
  const x = Math.floor(t);
  return lerp(ENTROPY[x & 255], ENTROPY[(x + 1) & 255], t - x) * (2 / 255) - 1;
}

function noise(t) {
  return octave(t * (1 /   1) +  3) * (  1 / 255) +
         octave(t * (1 /   2) +  5) * (  2 / 255) +
         octave(t * (1 /   4) +  7) * (  4 / 255) +
         octave(t * (1 /   8) + 11) * (  8 / 255) +
         octave(t * (1 /  16) + 13) * ( 16 / 255) +
         octave(t * (1 /  32) + 17) * ( 32 / 255) +
         octave(t * (1 /  64) + 19) * ( 64 / 255) +
         octave(t * (1 / 128) + 23) * (128 / 255);
}


const CANVAS = document.getElementsByTagName("canvas")[0];
CANVAS.width = WIDTH * SCALE;
CANVAS.height = HEIGHT * SCALE;

const CONTEXT = CANVAS.getContext("2d");
const ID = CONTEXT.getImageData(0, 0, CANVAS.width, CANVAS.height);

function constrain(x, min, max) {
  return (x > min)? ((x < max)? x: max): min;
}

function circle(x, y, r, t) {
  x = (x + noise(t * 256 +  0) * STROKE) * SCALE;
  y = (y + noise(t * 256 + 47) * STROKE) * SCALE;
  r = r * (1 + noise(t * 256 + 117) * (1 / 3)) * SCALE;

  const min_u = constrain(Math.floor(x - r), 0, ID.width);
  const min_v = constrain(Math.floor(y - r), 0, ID.height);
  const max_u = constrain(Math.ceil(x + r), 0, ID.width);
  const max_v = constrain(Math.ceil(y + r), 0, ID.height);

  for(let v = min_v; v < max_v; v++) {
    const dv = v + 0.5 - y;

    for(let u = min_u; u < max_u; u++) {
      const du = u + 0.5 - x;

      if(du * du + dv * dv <= r * r) {
        ID.data[(v * ID.width + u) * 4 + 3] = 255;
      }
    }
  }
}

function line(x1, y1, x2, y2) {
  next();

  const n = Math.ceil(Math.hypot(x2 - x1, y2 - y1) * 2 * SCALE);

  for(let i = 0; i < n; i++) {
    const t = i / n;
    circle(x1 + (x2 - x1) * t, y1 + (y2 - y1) * t, STROKE, t);
  }
}

function arc(x1, y1, x2, y2, r) {
  next();

  if(x1 === x2 && y1 === y2) {
    circle(x1 * SCALE, y1 * SCALE, STROKE * SCALE, 0);
    return;
  }

  const x = (x2 - x1) * 0.5;
  const y = (y2 - y1) * 0.5;
  const d = Math.sqrt(x * x + y * y);
  if(d > r) {
    return;
  }

  const m = Math.sqrt(r * r - d * d) / d;
  const u = y * m;
  const v = x * m;

  const s = Math.sign((x - u) * (y - v) - (y + v) * (x + u));
  const xc = x1 + x - u * s;
  const yc = y1 + y + v * s;

  const t1 = Math.atan2(yc - y1, x1 - xc);

  let t2 = Math.atan2(yc - y2, x2 - xc);
  if(t2 < t1) { t2 += 2 * Math.PI; }

  const n = Math.ceil((t2 - t1) * r * 2 * SCALE);

  for(let i = 0; i < n; i++) {
    const t = i / n;
    const tn = t1 + (t2 - t1) * t;

    circle(xc + Math.cos(tn) * r, yc - Math.sin(tn) * r, STROKE, t);
  }
}

function done() {
  CONTEXT.putImageData(ID, 0, 0);
}

arc(1, 1, 5, 1, 2);
arc(1, 1, 5, 1, 2.5);

arc(1, 4, 5, 4, 2);
line(1, 4, 5, 4);

arc(1, 8, 5, 8, 2);
arc(5, 8, 1, 8, 2.5);

arc(1, 13, 5, 13, 2);
arc(5, 13, 1, 13, 2);

arc(5, 18, 1, 18, 2);
arc(1, 18, 5, 18, 2.5);

arc(5, 22, 1, 22, 2);
line(5, 22, 1, 22);

arc(5, 25, 1, 25, 2);
arc(5, 25, 1, 25, 2.5);

done();
</script>
