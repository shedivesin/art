<!doctype html>
<canvas></canvas>
<script>
"use strict";
const WIDTH = 6;
const HEIGHT = 26;
const STROKE = 1/14;
const SCALE = 24;


const ENTROPY = new Uint8Array(16 * 3);

function next() {
  crypto.getRandomValues(ENTROPY);
}

function noise(t, i) {
  i = (Math.round(i) % 3) * 16;

  return Math.sin((t + ENTROPY[i +  0] * (1 / 256)) * (  2 * Math.PI)) * (ENTROPY[i +  1] * (1 / 256)) * (128 / 255) +
         Math.sin((t + ENTROPY[i +  2] * (1 / 256)) * (  4 * Math.PI)) * (ENTROPY[i +  3] * (1 / 256)) * ( 64 / 255) +
         Math.sin((t + ENTROPY[i +  4] * (1 / 256)) * (  8 * Math.PI)) * (ENTROPY[i +  5] * (1 / 256)) * ( 32 / 255) +
         Math.sin((t + ENTROPY[i +  6] * (1 / 256)) * ( 16 * Math.PI)) * (ENTROPY[i +  7] * (1 / 256)) * ( 16 / 255) +
         Math.sin((t + ENTROPY[i +  8] * (1 / 256)) * ( 32 * Math.PI)) * (ENTROPY[i +  9] * (1 / 256)) * (  8 / 255) +
         Math.sin((t + ENTROPY[i + 10] * (1 / 256)) * ( 64 * Math.PI)) * (ENTROPY[i + 11] * (1 / 256)) * (  4 / 255) +
         Math.sin((t + ENTROPY[i + 12] * (1 / 256)) * (128 * Math.PI)) * (ENTROPY[i + 13] * (1 / 256)) * (  2 / 255) +
         Math.sin((t + ENTROPY[i + 14] * (1 / 256)) * (256 * Math.PI)) * (ENTROPY[i + 15] * (1 / 256)) * (  1 / 255);
}


const CANVAS = document.getElementsByTagName("canvas")[0];
CANVAS.width = WIDTH * SCALE;
CANVAS.height = HEIGHT * SCALE;

const CONTEXT = CANVAS.getContext("2d");
const ID = CONTEXT.getImageData(0, 0, CANVAS.width, CANVAS.height);

function constrain(x, min, max) {
  return (x > min)? ((x < max)? x: max): min;
}

function dot(x, y, z) {
  x = (x + noise(z, 0) * STROKE) * SCALE;
  y = (y + noise(z, 1) * STROKE) * SCALE;

  const r = (1 + noise(z, 2) * 0.5) * STROKE * SCALE;
  const min_u = constrain(Math.floor(x - r), 0, ID.width);
  const min_v = constrain(Math.floor(y - r), 0, ID.height);
  const max_u = constrain(Math.ceil(x + r), 0, ID.width);
  const max_v = constrain(Math.ceil(y + r), 0, ID.height);

  for(let v = min_v; v < max_v; v++) {
    const dv = v + 0.5 - y;

    for(let u = min_u; u < max_u; u++) {
      const du = u + 0.5 - x;

      if(du * du + dv * dv <= r * r) {
        ID.data[(v * ID.width + u) * 4 + 3] = 255;
      }
    }
  }
}

function line(x1, y1, x2, y2, z1, z2) {
  const n = Math.ceil(Math.hypot(x2 - x1, y2 - y1) * 2 * SCALE);

  for(let i = 0; i < n; i++) {
    const t = i / n;
    dot(x1 + (x2 - x1) * t, y1 + (y2 - y1) * t, z1 + (z2 - z1) * t);
  }
}

function arc(x1, y1, x2, y2, r, z1, z2) {
  if(x1 === x2 && y1 === y2) {
    dot(x1, y1, z1);
    return;
  }

  const x = (x2 - x1) * 0.5;
  const y = (y2 - y1) * 0.5;
  const d = Math.sqrt(x * x + y * y);
  if(d > r) {
    return;
  }

  const m = Math.sqrt(r * r - d * d) / d;
  const u = y * m;
  const v = x * m;

  const s = Math.sign((x - u) * (y - v) - (y + v) * (x + u));
  const xc = x1 + x - u * s;
  const yc = y1 + y + v * s;

  const t1 = Math.atan2(yc - y1, x1 - xc);

  let t2 = Math.atan2(yc - y2, x2 - xc);
  if(t2 < t1) { t2 += 2 * Math.PI; }

  const n = Math.ceil((t2 - t1) * r * 2 * SCALE);

  for(let i = 0; i < n; i++) {
    const t = i / n;
    const tn = t1 + (t2 - t1) * t;

    dot(xc + Math.cos(tn) * r, yc - Math.sin(tn) * r, z1 + (z2 - z1) * t);
  }
}

function circle(x, y, r) {
  const n = Math.ceil(r * 4 * Math.PI * SCALE);

  for(let i = 0; i < n; i++) {
    const t = i / n;

    dot(x + Math.cos(t * 2 * Math.PI) * r, y - Math.sin(t * 2 * Math.PI) * r, t);
  }
}

function done() {
  CONTEXT.putImageData(ID, 0, 0);
}

next();
arc(1, 1, 5, 1, 2, 0, 0.5);
arc(1, 1, 5, 1, 2.5, 1, 0.5);

next();
arc(1, 4, 5, 4, 2, 0, 0.5);
line(5, 4, 1, 4, 0.5, 1);

next();
arc(1, 8, 5, 8, 2, 0, 0.5);
arc(5, 8, 1, 8, 2.5, 0.5, 1);

next();
circle(3, 13, 2);

next();
arc(5, 18, 1, 18, 2, 0, 0.5);
arc(1, 18, 5, 18, 2.5, 0.5, 1);

next();
arc(5, 22, 1, 22, 2, 0, 0.5);
line(1, 22, 5, 22, 0.5, 1);

next();
arc(5, 25, 1, 25, 2, 0, 0.5);
arc(5, 25, 1, 25, 2.5, 1, 0.5);

done();
</script>
